'use strict';const _0x1273b6=_0x20e1;(function(_0x4a90a7,_0x3b3683){const _0x1d4cbe=_0x20e1,_0x2953c7=_0x4a90a7();while(!![]){try{const _0x37d2f1=-parseInt(_0x1d4cbe(0x155))/0x1*(parseInt(_0x1d4cbe(0x147))/0x2)+parseInt(_0x1d4cbe(0x14b))/0x3+-parseInt(_0x1d4cbe(0x124))/0x4*(parseInt(_0x1d4cbe(0x156))/0x5)+parseInt(_0x1d4cbe(0x117))/0x6+-parseInt(_0x1d4cbe(0x153))/0x7+parseInt(_0x1d4cbe(0x14d))/0x8*(parseInt(_0x1d4cbe(0x119))/0x9)+parseInt(_0x1d4cbe(0x11d))/0xa;if(_0x37d2f1===_0x3b3683)break;else _0x2953c7['push'](_0x2953c7['shift']());}catch(_0x24f21e){_0x2953c7['push'](_0x2953c7['shift']());}}}(_0x8f6b,0x41e84));var __createBinding=this&&this[_0x1273b6(0x134)]||(Object['create']?function(_0x2bc9d2,_0x6a5304,_0x30b973,_0x28eb03){const _0x2ba524=_0x1273b6;if(_0x28eb03===undefined)_0x28eb03=_0x30b973;var _0x5ab1c7=Object['getOwnPropertyDescriptor'](_0x6a5304,_0x30b973);(!_0x5ab1c7||('get'in _0x5ab1c7?!_0x6a5304['__esModule']:_0x5ab1c7[_0x2ba524(0x13a)]||_0x5ab1c7[_0x2ba524(0x126)]))&&(_0x5ab1c7={'enumerable':!![],'get':function(){return _0x6a5304[_0x30b973];}}),Object[_0x2ba524(0x15a)](_0x2bc9d2,_0x28eb03,_0x5ab1c7);}:function(_0x4cd57c,_0x3faae6,_0x1014c0,_0x5b410f){if(_0x5b410f===undefined)_0x5b410f=_0x1014c0;_0x4cd57c[_0x5b410f]=_0x3faae6[_0x1014c0];}),__setModuleDefault=this&&this[_0x1273b6(0x132)]||(Object[_0x1273b6(0x14f)]?function(_0x4c4ea4,_0x314be7){const _0x3d24bf=_0x1273b6;Object['defineProperty'](_0x4c4ea4,_0x3d24bf(0x141),{'enumerable':!![],'value':_0x314be7});}:function(_0x29d2f0,_0x4e8dbe){const _0xe739c5=_0x1273b6;_0x29d2f0[_0xe739c5(0x141)]=_0x4e8dbe;}),__importStar=this&&this[_0x1273b6(0x150)]||function(_0x2e6587){const _0x289175=_0x1273b6;if(_0x2e6587&&_0x2e6587[_0x289175(0x140)])return _0x2e6587;var _0x350703={};if(_0x2e6587!=null){for(var _0x4eb22f in _0x2e6587)if(_0x4eb22f!=='default'&&Object[_0x289175(0x13d)]['hasOwnProperty'][_0x289175(0x13e)](_0x2e6587,_0x4eb22f))__createBinding(_0x350703,_0x2e6587,_0x4eb22f);}return __setModuleDefault(_0x350703,_0x2e6587),_0x350703;},__awaiter=this&&this[_0x1273b6(0x127)]||function(_0x34b3f4,_0x3eda63,_0x6ac05e,_0xc399d6){function _0x20f8cb(_0x5c2051){return _0x5c2051 instanceof _0x6ac05e?_0x5c2051:new _0x6ac05e(function(_0x40c127){_0x40c127(_0x5c2051);});}return new(_0x6ac05e||(_0x6ac05e=Promise))(function(_0xe9aa3c,_0x2bcbc5){const _0x38b509=_0x20e1;function _0x27791f(_0x2b8fa4){const _0x118d8c=_0x20e1;try{_0x2cae36(_0xc399d6[_0x118d8c(0x116)](_0x2b8fa4));}catch(_0x147569){_0x2bcbc5(_0x147569);}}function _0x281fe1(_0x4e9957){const _0x131bb9=_0x20e1;try{_0x2cae36(_0xc399d6[_0x131bb9(0x135)](_0x4e9957));}catch(_0x53b7f1){_0x2bcbc5(_0x53b7f1);}}function _0x2cae36(_0x2249e6){const _0x11e210=_0x20e1;_0x2249e6[_0x11e210(0x120)]?_0xe9aa3c(_0x2249e6[_0x11e210(0x115)]):_0x20f8cb(_0x2249e6['value'])[_0x11e210(0x15b)](_0x27791f,_0x281fe1);}_0x2cae36((_0xc399d6=_0xc399d6[_0x38b509(0x12e)](_0x34b3f4,_0x3eda63||[]))[_0x38b509(0x116)]());});},__importDefault=this&&this[_0x1273b6(0x148)]||function(_0x1c9f94){return _0x1c9f94&&_0x1c9f94['__esModule']?_0x1c9f94:{'default':_0x1c9f94};};Object[_0x1273b6(0x15a)](exports,_0x1273b6(0x140),{'value':!![]});const express_1=__importStar(require(_0x1273b6(0x128))),body_parser_1=require(_0x1273b6(0x13f)),api_router_1=require('./routes/api.router'),db_1=__importDefault(require('./config/db'));require(_0x1273b6(0x137));const mqtt_1=__importDefault(require(_0x1273b6(0x145))),connectMongoDBSession=__importStar(require(_0x1273b6(0x159))),constants_1=require(_0x1273b6(0x11b)),express_session_1=__importDefault(require('express-session')),path=__importStar(require(_0x1273b6(0x12a))),csurf_1=__importDefault(require('csurf')),dashboard_route_1=require('./routes/dashboard.route');require(_0x1273b6(0x144)),process['env']['TZ']=_0x1273b6(0x133);const app=(0x0,express_1[_0x1273b6(0x141)])();app[_0x1273b6(0x11a)]((0x0,body_parser_1['json'])());const MongoDBStore=connectMongoDBSession[_0x1273b6(0x141)](express_session_1['default']),sessionStore=MongoDBStore({'uri':constants_1[_0x1273b6(0x143)],'collection':_0x1273b6(0x11e),'expires':0x3e8*0x3c*0x3c*0x18*0x3});app[_0x1273b6(0x11a)]((0x0,express_session_1[_0x1273b6(0x141)])({'name':constants_1[_0x1273b6(0x14c)],'resave':!![],'saveUninitialized':!![],'secret':constants_1[_0x1273b6(0x131)],'rolling':!![],'store':sessionStore,'cookie':{'maxAge':0x1b77400}})),app[_0x1273b6(0x11a)]((_0x12e57c,_0x431167,_0x32ce14)=>{return _0x32ce14();}),app[_0x1273b6(0x11a)](_0x1273b6(0x113),api_router_1[_0x1273b6(0x12c)]),app[_0x1273b6(0x11a)]('/public',express_1['default'][_0x1273b6(0x152)](path[_0x1273b6(0x151)](__dirname,'/public'))),app[_0x1273b6(0x15c)](_0x1273b6(0x11c),_0x1273b6(0x121)),app['set'](_0x1273b6(0x114),path[_0x1273b6(0x151)](__dirname,'views')),app[_0x1273b6(0x15c)]('view\x20options',{'delimiter':'?'}),app[_0x1273b6(0x11a)]((0x0,express_1['urlencoded'])({'extended':!![]})),app[_0x1273b6(0x11a)]((0x0,csurf_1[_0x1273b6(0x141)])()),app[_0x1273b6(0x11a)](function(_0x336e42,_0x30bfc6,_0x3e9d63,_0x305ed5){const _0x2b55c7=_0x1273b6;console[_0x2b55c7(0x139)](_0x2b55c7(0x122)),console[_0x2b55c7(0x139)](_0x336e42);if(_0x336e42['code']!=='EBADCSRFTOKEN')return _0x305ed5(_0x336e42);return _0x3e9d63[_0x2b55c7(0x157)](0x193)[_0x2b55c7(0x129)]({'text':_0x2b55c7(0x12f),'status':![]});}),app[_0x1273b6(0x11a)]((_0x1691d2,_0x5a99b0,_0x5825d1)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x5ee92c=_0x1273b6;try{_0x5a99b0['locals'][_0x5ee92c(0x130)]=_0x1691d2[_0x5ee92c(0x158)]['isUserLoggedIn'],_0x5a99b0['locals'][_0x5ee92c(0x13b)]=_0x1691d2[_0x5ee92c(0x13b)](),_0x5a99b0[_0x5ee92c(0x136)][_0x5ee92c(0x138)]=[],_0x5a99b0[_0x5ee92c(0x136)]['scripts']=[],_0x5a99b0[_0x5ee92c(0x136)][_0x5ee92c(0x12d)]=_0x1691d2[_0x5ee92c(0x12d)],_0x5a99b0[_0x5ee92c(0x136)]['queries']=_0x1691d2[_0x5ee92c(0x14e)],_0x5825d1();}catch(_0x225e74){return console[_0x5ee92c(0x12f)](_0x5ee92c(0x118)),console[_0x5ee92c(0x123)](_0x225e74),_0x5a99b0[_0x5ee92c(0x129)]({'status':![],'text':'خطایی\x20پیش\x20آمده'});}})),app[_0x1273b6(0x11a)]('/dashboard',dashboard_route_1[_0x1273b6(0x154)]),app[_0x1273b6(0x11a)](_0x1273b6(0x15d),(_0x51d7fc,_0x48d3b9)=>{const _0x2e4b12=_0x1273b6;return _0x48d3b9[_0x2e4b12(0x149)](_0x2e4b12(0x146));}),app[_0x1273b6(0x11a)](_0x1273b6(0x14a),(_0x51be08,_0x294b9d)=>{const _0x1cc43a=_0x1273b6;return _0x294b9d['render'](_0x1cc43a(0x13c));});const PORT=process['env'][_0x1273b6(0x142)]||0x2260;(0x0,db_1[_0x1273b6(0x141)])()[_0x1273b6(0x15b)](()=>{const _0x28d6f8=_0x1273b6;console[_0x28d6f8(0x139)]('mongo\x20database\x20connected'),mqtt_1['default'][_0x28d6f8(0x11f)]()['connect'](),app[_0x28d6f8(0x125)](PORT,()=>console[_0x28d6f8(0x139)](_0x28d6f8(0x12b)+PORT));});function _0x20e1(_0x541dbc,_0x19578d){const _0x8f6b7c=_0x8f6b();return _0x20e1=function(_0x20e18b,_0x2a4f23){_0x20e18b=_0x20e18b-0x113;let _0x43f5a1=_0x8f6b7c[_0x20e18b];return _0x43f5a1;},_0x20e1(_0x541dbc,_0x19578d);}function _0x8f6b(){const _0x249c67=['__createBinding','throw','locals','./types/global.type','styles','log','writable','csrfToken','error/403.ejs','prototype','call','body-parser','__esModule','default','PORT','mongoConnection','./types/session','./classes/mqtt','error/404.ejs','2WMyLgZ','__importDefault','render','/error/403','628410rMRjxM','sessionName','3094440zgfNek','query','create','__importStar','join','static','49427uuxbcy','dashboardRoute','411938mfeoey','530OHWfpb','status','session','connect-mongodb-session','defineProperty','then','set','/error/404','/api','views','value','next','2095608HtelRb','error\x20in\x20locals','9rLHFHE','use','./utility/constants','view\x20engine','2044060zLxWRc','sessions','getInstance','done','ejs','its\x20a\x20error\x20catrch\x20it','dir','17396dVAgTL','listen','configurable','__awaiter','express','json','path','server\x20start\x20at\x20','apiRouter','hostname','apply','error','isAuthenticated','sessionSecret','__setModuleDefault','Asia/Tehran'];_0x8f6b=function(){return _0x249c67;};return _0x8f6b();}