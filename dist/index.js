'use strict';const _0x45a9a1=_0x5142;(function(_0x49c69a,_0x41c473){const _0x4713c4=_0x5142,_0x5b9fe0=_0x49c69a();while(!![]){try{const _0x44b27a=-parseInt(_0x4713c4(0x1bd))/0x1*(parseInt(_0x4713c4(0x187))/0x2)+-parseInt(_0x4713c4(0x17d))/0x3+parseInt(_0x4713c4(0x1ba))/0x4+-parseInt(_0x4713c4(0x1ad))/0x5+parseInt(_0x4713c4(0x183))/0x6*(parseInt(_0x4713c4(0x1b5))/0x7)+parseInt(_0x4713c4(0x18b))/0x8*(parseInt(_0x4713c4(0x19e))/0x9)+parseInt(_0x4713c4(0x19a))/0xa*(parseInt(_0x4713c4(0x175))/0xb);if(_0x44b27a===_0x41c473)break;else _0x5b9fe0['push'](_0x5b9fe0['shift']());}catch(_0x30a198){_0x5b9fe0['push'](_0x5b9fe0['shift']());}}}(_0x4341,0x54f7d));var __createBinding=this&&this[_0x45a9a1(0x185)]||(Object[_0x45a9a1(0x1aa)]?function(_0x30a118,_0x5720dd,_0x576b2e,_0x192fb3){const _0x237800=_0x45a9a1;if(_0x192fb3===undefined)_0x192fb3=_0x576b2e;var _0x5c693c=Object['getOwnPropertyDescriptor'](_0x5720dd,_0x576b2e);(!_0x5c693c||(_0x237800(0x176)in _0x5c693c?!_0x5720dd[_0x237800(0x17a)]:_0x5c693c[_0x237800(0x1a1)]||_0x5c693c[_0x237800(0x189)]))&&(_0x5c693c={'enumerable':!![],'get':function(){return _0x5720dd[_0x576b2e];}}),Object[_0x237800(0x1a5)](_0x30a118,_0x192fb3,_0x5c693c);}:function(_0x46c96a,_0x3b8f1c,_0x142def,_0x4d1efb){if(_0x4d1efb===undefined)_0x4d1efb=_0x142def;_0x46c96a[_0x4d1efb]=_0x3b8f1c[_0x142def];}),__setModuleDefault=this&&this[_0x45a9a1(0x1b0)]||(Object['create']?function(_0x4801c4,_0x52fdd1){const _0x5da94f=_0x45a9a1;Object['defineProperty'](_0x4801c4,_0x5da94f(0x18e),{'enumerable':!![],'value':_0x52fdd1});}:function(_0x2d181d,_0x50985e){const _0x3babec=_0x45a9a1;_0x2d181d[_0x3babec(0x18e)]=_0x50985e;}),__importStar=this&&this[_0x45a9a1(0x1ab)]||function(_0x5da7bd){const _0xa9af4b=_0x45a9a1;if(_0x5da7bd&&_0x5da7bd[_0xa9af4b(0x17a)])return _0x5da7bd;var _0x50558f={};if(_0x5da7bd!=null){for(var _0x3d5214 in _0x5da7bd)if(_0x3d5214!==_0xa9af4b(0x18e)&&Object['prototype'][_0xa9af4b(0x17f)]['call'](_0x5da7bd,_0x3d5214))__createBinding(_0x50558f,_0x5da7bd,_0x3d5214);}return __setModuleDefault(_0x50558f,_0x5da7bd),_0x50558f;},__awaiter=this&&this[_0x45a9a1(0x19d)]||function(_0x2b8f6,_0x144c3e,_0x513d0f,_0x5ecc8c){function _0x43ba1d(_0x5d0aca){return _0x5d0aca instanceof _0x513d0f?_0x5d0aca:new _0x513d0f(function(_0x43eacb){_0x43eacb(_0x5d0aca);});}return new(_0x513d0f||(_0x513d0f=Promise))(function(_0x50fb17,_0x5886c3){const _0x3fb673=_0x5142;function _0x10e227(_0x29787c){const _0x4d7bcd=_0x5142;try{_0x21b079(_0x5ecc8c[_0x4d7bcd(0x17c)](_0x29787c));}catch(_0x125920){_0x5886c3(_0x125920);}}function _0x489c34(_0xc62b5e){const _0x971b4d=_0x5142;try{_0x21b079(_0x5ecc8c[_0x971b4d(0x196)](_0xc62b5e));}catch(_0x19d879){_0x5886c3(_0x19d879);}}function _0x21b079(_0x5689d9){const _0x46d2ae=_0x5142;_0x5689d9['done']?_0x50fb17(_0x5689d9[_0x46d2ae(0x1bb)]):_0x43ba1d(_0x5689d9[_0x46d2ae(0x1bb)])[_0x46d2ae(0x197)](_0x10e227,_0x489c34);}_0x21b079((_0x5ecc8c=_0x5ecc8c[_0x3fb673(0x174)](_0x2b8f6,_0x144c3e||[]))['next']());});},__importDefault=this&&this['__importDefault']||function(_0x14959b){const _0x39eaab=_0x45a9a1;return _0x14959b&&_0x14959b[_0x39eaab(0x17a)]?_0x14959b:{'default':_0x14959b};};Object[_0x45a9a1(0x1a5)](exports,'__esModule',{'value':!![]});const express_1=__importStar(require(_0x45a9a1(0x19f))),body_parser_1=require(_0x45a9a1(0x192)),api_router_1=require(_0x45a9a1(0x191)),db_1=__importDefault(require(_0x45a9a1(0x1a0)));require(_0x45a9a1(0x172));const mqtt_1=__importDefault(require(_0x45a9a1(0x194))),connectMongoDBSession=__importStar(require(_0x45a9a1(0x181))),constants_1=require(_0x45a9a1(0x188)),express_session_1=__importDefault(require(_0x45a9a1(0x1a8))),path=__importStar(require(_0x45a9a1(0x1bc))),csurf_1=__importDefault(require('csurf')),dashboard_route_1=require('./routes/dashboard.route');require(_0x45a9a1(0x199)),process[_0x45a9a1(0x198)]['TZ']=_0x45a9a1(0x1c0);function _0x4341(){const _0x3f0d16=['set','Asia/Tehran','error/404.ejs','/public','view\x20engine','./types/global.type','render','apply','11bOBnuK','get','sessionName','error','isUserLoggedIn','__esModule','log','next','1188540FSRHzj','its\x20a\x20error\x20catrch\x20it','hasOwnProperty','error/403.ejs','connect-mongodb-session','getInstance','6xXPvvl','view\x20options','__createBinding','csrfToken','115798YEtAVc','./utility/constants','configurable','join','8LhktZg','json','server\x20start\x20at\x20','default','scripts','ejs','./routes/api.router','body-parser','خطایی\x20پیش\x20آمده','./classes/mqtt','code','throw','then','env','./types/session','1903970WuCUOU','listen','static','__awaiter','1164654FRIHFa','express','./config/db','writable','urlencoded','query','locals','defineProperty','session','views','express-session','isAuthenticated','create','__importStar','mongo\x20database\x20connected','1071895TOggNj','styles','/error/403','__setModuleDefault','sessions','mongoConnection','connect','PORT','4583369mQOmyF','apiRouter','hostname','/dashboard','use','1557244lzDpsT','value','path','7wfhbKC','queries'];_0x4341=function(){return _0x3f0d16;};return _0x4341();}function _0x5142(_0x51317a,_0x4fd205){const _0x43415d=_0x4341();return _0x5142=function(_0x514203,_0x168480){_0x514203=_0x514203-0x171;let _0x197ac2=_0x43415d[_0x514203];return _0x197ac2;},_0x5142(_0x51317a,_0x4fd205);}const app=(0x0,express_1[_0x45a9a1(0x18e)])();app[_0x45a9a1(0x1b9)]((0x0,body_parser_1['json'])());const MongoDBStore=connectMongoDBSession['default'](express_session_1['default']),sessionStore=MongoDBStore({'uri':constants_1[_0x45a9a1(0x1b2)],'collection':_0x45a9a1(0x1b1),'expires':0x3e8*0x3c*0x3c*0x18*0x3});app[_0x45a9a1(0x1b9)]((0x0,express_session_1[_0x45a9a1(0x18e)])({'name':constants_1[_0x45a9a1(0x177)],'resave':!![],'saveUninitialized':!![],'secret':constants_1['sessionSecret'],'rolling':!![],'store':sessionStore,'cookie':{'maxAge':0x1b77400}})),app[_0x45a9a1(0x1b9)]((_0x16d3b9,_0xf8db7a,_0x39341f)=>{return _0x39341f();}),app['use']('/api',api_router_1[_0x45a9a1(0x1b6)]),app[_0x45a9a1(0x1b9)]('/public',express_1['default'][_0x45a9a1(0x19c)](path[_0x45a9a1(0x18a)](__dirname,_0x45a9a1(0x1c2)))),app[_0x45a9a1(0x1bf)](_0x45a9a1(0x171),_0x45a9a1(0x190)),app[_0x45a9a1(0x1bf)](_0x45a9a1(0x1a7),path[_0x45a9a1(0x18a)](__dirname,'views')),app['set'](_0x45a9a1(0x184),{'delimiter':'?'}),app[_0x45a9a1(0x1b9)]((0x0,express_1[_0x45a9a1(0x1a2)])({'extended':!![]})),app[_0x45a9a1(0x1b9)]((0x0,csurf_1[_0x45a9a1(0x18e)])()),app[_0x45a9a1(0x1b9)](function(_0x48d07a,_0x2fbd6a,_0x2204d7,_0x51e295){const _0x5af7a5=_0x45a9a1;console[_0x5af7a5(0x17b)](_0x5af7a5(0x17e)),console['log'](_0x48d07a);if(_0x48d07a[_0x5af7a5(0x195)]!=='EBADCSRFTOKEN')return _0x51e295(_0x48d07a);return _0x2204d7['status'](0x193)[_0x5af7a5(0x18c)]({'text':'error','status':![]});}),app[_0x45a9a1(0x1b9)]((_0x818f7b,_0x5a6374,_0x20c476)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x804035=_0x45a9a1;try{_0x5a6374[_0x804035(0x1a4)][_0x804035(0x1a9)]=_0x818f7b[_0x804035(0x1a6)][_0x804035(0x179)],_0x5a6374[_0x804035(0x1a4)][_0x804035(0x186)]=_0x818f7b['csrfToken'](),_0x5a6374['locals'][_0x804035(0x1ae)]=[],_0x5a6374[_0x804035(0x1a4)][_0x804035(0x18f)]=[],_0x5a6374[_0x804035(0x1a4)][_0x804035(0x1b7)]=_0x818f7b[_0x804035(0x1b7)],_0x5a6374[_0x804035(0x1a4)][_0x804035(0x1be)]=_0x818f7b[_0x804035(0x1a3)],_0x20c476();}catch(_0x189674){return console[_0x804035(0x178)]('error\x20in\x20locals'),console['dir'](_0x189674),_0x5a6374['json']({'status':![],'text':_0x804035(0x193)});}})),app[_0x45a9a1(0x1b9)](_0x45a9a1(0x1b8),dashboard_route_1['dashboardRoute']),app['use']('/error/404',(_0x435afc,_0x10a82b)=>{const _0x104c45=_0x45a9a1;return _0x10a82b[_0x104c45(0x173)](_0x104c45(0x1c1));}),app[_0x45a9a1(0x1b9)](_0x45a9a1(0x1af),(_0x5f3acc,_0x27f8fd)=>{const _0x176c44=_0x45a9a1;return _0x27f8fd[_0x176c44(0x173)](_0x176c44(0x180));});const PORT=process['env'][_0x45a9a1(0x1b4)]||0x2260;(0x0,db_1[_0x45a9a1(0x18e)])()[_0x45a9a1(0x197)](()=>{const _0x51d417=_0x45a9a1;console['log'](_0x51d417(0x1ac)),mqtt_1[_0x51d417(0x18e)][_0x51d417(0x182)]()[_0x51d417(0x1b3)](),app[_0x51d417(0x19b)](PORT,()=>console[_0x51d417(0x17b)](_0x51d417(0x18d)+PORT));});