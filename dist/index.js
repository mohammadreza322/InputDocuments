'use strict';const _0x49b5e9=_0x54be;(function(_0x56d782,_0x3eccf8){const _0x31b7bf=_0x54be,_0x4c67d5=_0x56d782();while(!![]){try{const _0x446ab7=-parseInt(_0x31b7bf(0x16c))/0x1+-parseInt(_0x31b7bf(0x180))/0x2*(parseInt(_0x31b7bf(0x175))/0x3)+parseInt(_0x31b7bf(0x1b0))/0x4+-parseInt(_0x31b7bf(0x1b2))/0x5+-parseInt(_0x31b7bf(0x179))/0x6*(parseInt(_0x31b7bf(0x18a))/0x7)+parseInt(_0x31b7bf(0x1b3))/0x8+parseInt(_0x31b7bf(0x189))/0x9*(parseInt(_0x31b7bf(0x196))/0xa);if(_0x446ab7===_0x3eccf8)break;else _0x4c67d5['push'](_0x4c67d5['shift']());}catch(_0x4f3869){_0x4c67d5['push'](_0x4c67d5['shift']());}}}(_0x2813,0x27c19));var __createBinding=this&&this['__createBinding']||(Object[_0x49b5e9(0x16e)]?function(_0x232e30,_0x27ff31,_0xc17692,_0x34e478){const _0x3565fd=_0x49b5e9;if(_0x34e478===undefined)_0x34e478=_0xc17692;var _0x44406b=Object[_0x3565fd(0x187)](_0x27ff31,_0xc17692);(!_0x44406b||(_0x3565fd(0x173)in _0x44406b?!_0x27ff31['__esModule']:_0x44406b[_0x3565fd(0x177)]||_0x44406b[_0x3565fd(0x18c)]))&&(_0x44406b={'enumerable':!![],'get':function(){return _0x27ff31[_0xc17692];}}),Object['defineProperty'](_0x232e30,_0x34e478,_0x44406b);}:function(_0x335f6a,_0x2df41b,_0x16470a,_0x1ce07b){if(_0x1ce07b===undefined)_0x1ce07b=_0x16470a;_0x335f6a[_0x1ce07b]=_0x2df41b[_0x16470a];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x3e0f10,_0xd6cc3d){const _0x309b72=_0x49b5e9;Object[_0x309b72(0x186)](_0x3e0f10,_0x309b72(0x1ab),{'enumerable':!![],'value':_0xd6cc3d});}:function(_0x52d853,_0x4640f9){const _0x3af642=_0x49b5e9;_0x52d853[_0x3af642(0x1ab)]=_0x4640f9;}),__importStar=this&&this['__importStar']||function(_0x3f180a){const _0x4b5810=_0x49b5e9;if(_0x3f180a&&_0x3f180a[_0x4b5810(0x198)])return _0x3f180a;var _0x13827c={};if(_0x3f180a!=null){for(var _0x314151 in _0x3f180a)if(_0x314151!==_0x4b5810(0x1ab)&&Object['prototype']['hasOwnProperty'][_0x4b5810(0x1aa)](_0x3f180a,_0x314151))__createBinding(_0x13827c,_0x3f180a,_0x314151);}return __setModuleDefault(_0x13827c,_0x3f180a),_0x13827c;},__awaiter=this&&this[_0x49b5e9(0x188)]||function(_0x5a5ad1,_0xfc48e5,_0x4fc40b,_0x471755){function _0x9b2507(_0x5d447f){return _0x5d447f instanceof _0x4fc40b?_0x5d447f:new _0x4fc40b(function(_0x5bb41d){_0x5bb41d(_0x5d447f);});}return new(_0x4fc40b||(_0x4fc40b=Promise))(function(_0xc6bf28,_0x5e3689){function _0x3402cc(_0x59f40b){const _0xedf33f=_0x54be;try{_0x2c41b1(_0x471755[_0xedf33f(0x18f)](_0x59f40b));}catch(_0x288559){_0x5e3689(_0x288559);}}function _0x82f19(_0x2020da){const _0x37dc8e=_0x54be;try{_0x2c41b1(_0x471755[_0x37dc8e(0x1ae)](_0x2020da));}catch(_0x32b771){_0x5e3689(_0x32b771);}}function _0x2c41b1(_0xad9309){const _0x3383af=_0x54be;_0xad9309['done']?_0xc6bf28(_0xad9309[_0x3383af(0x1b4)]):_0x9b2507(_0xad9309[_0x3383af(0x1b4)])[_0x3383af(0x170)](_0x3402cc,_0x82f19);}_0x2c41b1((_0x471755=_0x471755['apply'](_0x5a5ad1,_0xfc48e5||[]))['next']());});},__importDefault=this&&this[_0x49b5e9(0x171)]||function(_0x7ecb65){const _0x3c3820=_0x49b5e9;return _0x7ecb65&&_0x7ecb65[_0x3c3820(0x198)]?_0x7ecb65:{'default':_0x7ecb65};};Object[_0x49b5e9(0x186)](exports,_0x49b5e9(0x198),{'value':!![]});const express_1=__importStar(require(_0x49b5e9(0x183))),body_parser_1=require(_0x49b5e9(0x191)),api_router_1=require(_0x49b5e9(0x1a9)),db_1=__importDefault(require(_0x49b5e9(0x176)));require(_0x49b5e9(0x17c));function _0x2813(){const _0x381cc6=['/error/403','خطایی\x20پیش\x20آمده','log','/public','dashboardRoute','mongoConnection','./routes/api.router','call','default','EBADCSRFTOKEN','views','throw','path','709304kaXDLl','isUserLoggedIn','1044105CUEdrl','43216OtBcwX','value','PORT','express-session','join','queries','status','/api','314076VszKZN','dir','create','view\x20engine','then','__importDefault','server\x20start\x20at\x20','get','query','50187VYFddz','./config/db','writable','csrfToken','326028SQeDzQ','error\x20in\x20locals','./utility/constants','./types/global.type','csurf','./classes/mqtt','static','26cAwJYf','set','hostname','express','getInstance','urlencoded','defineProperty','getOwnPropertyDescriptor','__awaiter','7951509LdVUBL','21rpttsd','scripts','configurable','apiRouter','connect','next','use','body-parser','ejs','env','error','sessionName','10cNLhAb','json','__esModule','Asia/Tehran','render','error/403.ejs','locals','./routes/dashboard.route','connect-mongodb-session','isAuthenticated','code','styles','session'];_0x2813=function(){return _0x381cc6;};return _0x2813();}const mqtt_1=__importDefault(require(_0x49b5e9(0x17e))),connectMongoDBSession=__importStar(require(_0x49b5e9(0x19e))),constants_1=require(_0x49b5e9(0x17b)),express_session_1=__importDefault(require(_0x49b5e9(0x1b6))),path=__importStar(require(_0x49b5e9(0x1af))),csurf_1=__importDefault(require(_0x49b5e9(0x17d))),dashboard_route_1=require(_0x49b5e9(0x19d));require('./types/session'),process[_0x49b5e9(0x193)]['TZ']=_0x49b5e9(0x199);const app=(0x0,express_1[_0x49b5e9(0x1ab)])();app[_0x49b5e9(0x190)]((0x0,body_parser_1[_0x49b5e9(0x197)])()),app['use']((_0x16553b,_0x332017,_0x448214)=>{return _0x448214();});const MongoDBStore=connectMongoDBSession[_0x49b5e9(0x1ab)](express_session_1[_0x49b5e9(0x1ab)]),sessionStore=MongoDBStore({'uri':constants_1[_0x49b5e9(0x1a8)],'collection':'sessions','expires':0x3e8*0x3c*0x3c*0x18*0x3});function _0x54be(_0x867604,_0x41a04){const _0x2813d5=_0x2813();return _0x54be=function(_0x54be49,_0x35986b){_0x54be49=_0x54be49-0x16b;let _0x447ecd=_0x2813d5[_0x54be49];return _0x447ecd;},_0x54be(_0x867604,_0x41a04);}app[_0x49b5e9(0x190)]((0x0,express_session_1[_0x49b5e9(0x1ab)])({'name':constants_1[_0x49b5e9(0x195)],'resave':!![],'saveUninitialized':!![],'secret':constants_1['sessionSecret'],'rolling':!![],'store':sessionStore,'cookie':{'maxAge':0x1b77400}})),app[_0x49b5e9(0x190)](_0x49b5e9(0x16b),api_router_1[_0x49b5e9(0x18d)]),app['use'](_0x49b5e9(0x1a6),express_1[_0x49b5e9(0x1ab)][_0x49b5e9(0x17f)](path[_0x49b5e9(0x1b7)](__dirname,_0x49b5e9(0x1a6)))),app[_0x49b5e9(0x181)](_0x49b5e9(0x16f),_0x49b5e9(0x192)),app[_0x49b5e9(0x181)](_0x49b5e9(0x1ad),path[_0x49b5e9(0x1b7)](__dirname,_0x49b5e9(0x1ad))),app['set']('view\x20options',{'delimiter':'?'}),app[_0x49b5e9(0x190)]((0x0,express_1[_0x49b5e9(0x185)])({'extended':!![]})),app[_0x49b5e9(0x190)]((0x0,csurf_1[_0x49b5e9(0x1ab)])()),app[_0x49b5e9(0x190)](function(_0xc5befa,_0x29d247,_0x1df3ef,_0x550b71){const _0x171a67=_0x49b5e9;console[_0x171a67(0x1a5)]('its\x20a\x20error\x20catrch\x20it'),console['log'](_0xc5befa);if(_0xc5befa[_0x171a67(0x1a0)]!==_0x171a67(0x1ac))return _0x550b71(_0xc5befa);return _0x1df3ef[_0x171a67(0x1b9)](0x193)['json']({'text':_0x171a67(0x194),'status':![]});}),app[_0x49b5e9(0x190)]((_0x4c5666,_0x38354b,_0x1a9bd1)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x14d868=_0x49b5e9;try{_0x38354b['locals'][_0x14d868(0x19f)]=_0x4c5666[_0x14d868(0x1a2)][_0x14d868(0x1b1)],_0x38354b[_0x14d868(0x19c)][_0x14d868(0x178)]=_0x4c5666['csrfToken'](),_0x38354b[_0x14d868(0x19c)][_0x14d868(0x1a1)]=[],_0x38354b[_0x14d868(0x19c)][_0x14d868(0x18b)]=[],_0x38354b[_0x14d868(0x19c)][_0x14d868(0x182)]=_0x4c5666[_0x14d868(0x182)],_0x38354b[_0x14d868(0x19c)][_0x14d868(0x1b8)]=_0x4c5666[_0x14d868(0x174)],_0x1a9bd1();}catch(_0x2e50cb){return console['error'](_0x14d868(0x17a)),console[_0x14d868(0x16d)](_0x2e50cb),_0x38354b['json']({'status':![],'text':_0x14d868(0x1a4)});}})),app[_0x49b5e9(0x190)]('/dashboard',dashboard_route_1[_0x49b5e9(0x1a7)]),app[_0x49b5e9(0x190)]('/error/404',(_0x16957a,_0x295cbe)=>{const _0x17501b=_0x49b5e9;return _0x295cbe[_0x17501b(0x19a)]('error/404.ejs');}),app['use'](_0x49b5e9(0x1a3),(_0x6b5fd,_0x34e370)=>{const _0x173aa7=_0x49b5e9;return _0x34e370['render'](_0x173aa7(0x19b));});const PORT=process['env'][_0x49b5e9(0x1b5)]||0x2260;(0x0,db_1['default'])()[_0x49b5e9(0x170)](()=>{const _0x1677f8=_0x49b5e9;console['log']('mongo\x20database\x20connected'),mqtt_1['default'][_0x1677f8(0x184)]()[_0x1677f8(0x18e)](),app['listen'](PORT,()=>console['log'](_0x1677f8(0x172)+PORT));});