'use strict';const _0x460b6d=_0x342b;(function(_0x45a3e5,_0x1dbf17){const _0x42c475=_0x342b,_0x24174f=_0x45a3e5();while(!![]){try{const _0x3183a9=-parseInt(_0x42c475(0x1d5))/0x1+-parseInt(_0x42c475(0x19b))/0x2*(parseInt(_0x42c475(0x1dd))/0x3)+-parseInt(_0x42c475(0x1d9))/0x4+-parseInt(_0x42c475(0x1d6))/0x5*(-parseInt(_0x42c475(0x19a))/0x6)+parseInt(_0x42c475(0x1c1))/0x7+parseInt(_0x42c475(0x1ad))/0x8+-parseInt(_0x42c475(0x1b4))/0x9*(-parseInt(_0x42c475(0x1a5))/0xa);if(_0x3183a9===_0x1dbf17)break;else _0x24174f['push'](_0x24174f['shift']());}catch(_0x3e7da9){_0x24174f['push'](_0x24174f['shift']());}}}(_0x1cf2,0xd6184));var __createBinding=this&&this[_0x460b6d(0x1d7)]||(Object[_0x460b6d(0x19d)]?function(_0x577b5a,_0x2f4fe5,_0x2816b1,_0x18a7fa){const _0x51b3ed=_0x460b6d;if(_0x18a7fa===undefined)_0x18a7fa=_0x2816b1;var _0x1f0a48=Object[_0x51b3ed(0x1aa)](_0x2f4fe5,_0x2816b1);(!_0x1f0a48||(_0x51b3ed(0x1bd)in _0x1f0a48?!_0x2f4fe5[_0x51b3ed(0x1e3)]:_0x1f0a48[_0x51b3ed(0x1c7)]||_0x1f0a48['configurable']))&&(_0x1f0a48={'enumerable':!![],'get':function(){return _0x2f4fe5[_0x2816b1];}}),Object['defineProperty'](_0x577b5a,_0x18a7fa,_0x1f0a48);}:function(_0x1ad972,_0xc36621,_0x2ec2aa,_0x553371){if(_0x553371===undefined)_0x553371=_0x2ec2aa;_0x1ad972[_0x553371]=_0xc36621[_0x2ec2aa];}),__setModuleDefault=this&&this[_0x460b6d(0x1c0)]||(Object[_0x460b6d(0x19d)]?function(_0x26bc87,_0x77f6a2){const _0x35dc87=_0x460b6d;Object[_0x35dc87(0x1a2)](_0x26bc87,_0x35dc87(0x1e4),{'enumerable':!![],'value':_0x77f6a2});}:function(_0xbb7f64,_0x5035c8){const _0x4039cb=_0x460b6d;_0xbb7f64[_0x4039cb(0x1e4)]=_0x5035c8;}),__importStar=this&&this[_0x460b6d(0x1cb)]||function(_0x5847e6){const _0xda1b59=_0x460b6d;if(_0x5847e6&&_0x5847e6[_0xda1b59(0x1e3)])return _0x5847e6;var _0xbafc8f={};if(_0x5847e6!=null){for(var _0xbf763a in _0x5847e6)if(_0xbf763a!==_0xda1b59(0x1e4)&&Object[_0xda1b59(0x1da)][_0xda1b59(0x1d4)][_0xda1b59(0x1d2)](_0x5847e6,_0xbf763a))__createBinding(_0xbafc8f,_0x5847e6,_0xbf763a);}return __setModuleDefault(_0xbafc8f,_0x5847e6),_0xbafc8f;},__awaiter=this&&this['__awaiter']||function(_0x51c7d1,_0x494178,_0x398a4b,_0x237a0a){function _0x33bd52(_0x217d9e){return _0x217d9e instanceof _0x398a4b?_0x217d9e:new _0x398a4b(function(_0x265818){_0x265818(_0x217d9e);});}return new(_0x398a4b||(_0x398a4b=Promise))(function(_0x26f3fd,_0x31e9a1){const _0x30e2bc=_0x342b;function _0x4dc75c(_0x36ace7){const _0x2287e2=_0x342b;try{_0x6b641c(_0x237a0a[_0x2287e2(0x1b0)](_0x36ace7));}catch(_0x19eb29){_0x31e9a1(_0x19eb29);}}function _0x14db31(_0x472a1f){const _0x3348b7=_0x342b;try{_0x6b641c(_0x237a0a[_0x3348b7(0x1dc)](_0x472a1f));}catch(_0x3bae75){_0x31e9a1(_0x3bae75);}}function _0x6b641c(_0x56ced4){const _0x2f0777=_0x342b;_0x56ced4[_0x2f0777(0x1b3)]?_0x26f3fd(_0x56ced4[_0x2f0777(0x1de)]):_0x33bd52(_0x56ced4[_0x2f0777(0x1de)])['then'](_0x4dc75c,_0x14db31);}_0x6b641c((_0x237a0a=_0x237a0a[_0x30e2bc(0x1e1)](_0x51c7d1,_0x494178||[]))['next']());});},__importDefault=this&&this[_0x460b6d(0x1cc)]||function(_0x230418){const _0x5c56f9=_0x460b6d;return _0x230418&&_0x230418[_0x5c56f9(0x1e3)]?_0x230418:{'default':_0x230418};};function _0x342b(_0x109a6e,_0xd874e){const _0x1cf260=_0x1cf2();return _0x342b=function(_0x342bd1,_0x5ee3d3){_0x342bd1=_0x342bd1-0x199;let _0x2a4bba=_0x1cf260[_0x342bd1];return _0x2a4bba;},_0x342b(_0x109a6e,_0xd874e);}Object['defineProperty'](exports,_0x460b6d(0x1e3),{'value':!![]});const express_1=__importStar(require(_0x460b6d(0x1ca))),body_parser_1=require(_0x460b6d(0x1b2)),api_router_1=require(_0x460b6d(0x1ce)),db_1=__importDefault(require(_0x460b6d(0x1c2)));function _0x1cf2(){const _0x2fab7f=['sessionName','42fwheiM','1939498QwmPoQ','error/403.ejs','create','./routes/dashboard.route','styles','join','scripts','defineProperty','/api','./types/session','110zVOAvT','express-session','env','خطایی\x20پیش\x20آمده','ejs','getOwnPropertyDescriptor','queries','log','2646352bMyYxm','then','status','next','connect-mongodb-session','body-parser','done','1268613kGQGrB','set','session','Asia/Tehran','connect','view\x20engine','sessionSecret','mongo\x20database\x20connected','render','get','query','/error/403','__setModuleDefault','5344871LgZLVU','./config/db','urlencoded','./classes/mqtt','hostname','its\x20a\x20error\x20catrch\x20it','writable','PORT','locals','express','__importStar','__importDefault','path','./routes/api.router','views','error','/public','call','use','hasOwnProperty','1560896rokevy','631585dPMMuq','__createBinding','json','486064XyUnFK','prototype','csurf','throw','3wMRcga','value','isAuthenticated','csrfToken','apply','/error/404','__esModule','default'];_0x1cf2=function(){return _0x2fab7f;};return _0x1cf2();}require('./types/global.type');const mqtt_1=__importDefault(require(_0x460b6d(0x1c4))),connectMongoDBSession=__importStar(require(_0x460b6d(0x1b1))),constants_1=require('./utility/constants'),express_session_1=__importDefault(require(_0x460b6d(0x1a6))),path=__importStar(require(_0x460b6d(0x1cd))),csurf_1=__importDefault(require(_0x460b6d(0x1db))),dashboard_route_1=require(_0x460b6d(0x19e));require(_0x460b6d(0x1a4)),process[_0x460b6d(0x1a7)]['TZ']=_0x460b6d(0x1b7);const app=(0x0,express_1[_0x460b6d(0x1e4)])();app[_0x460b6d(0x1d3)]((0x0,body_parser_1[_0x460b6d(0x1d8)])()),app[_0x460b6d(0x1d3)]((_0x56bdc2,_0x58cb87,_0x47b0ac)=>{return _0x47b0ac();});const MongoDBStore=connectMongoDBSession[_0x460b6d(0x1e4)](express_session_1[_0x460b6d(0x1e4)]),sessionStore=MongoDBStore({'uri':constants_1['mongoConnection'],'collection':'sessions','expires':0x3e8*0x3c*0x3c*0x18*0x3});app[_0x460b6d(0x1d3)]((0x0,express_session_1[_0x460b6d(0x1e4)])({'name':constants_1[_0x460b6d(0x199)],'resave':!![],'saveUninitialized':!![],'secret':constants_1[_0x460b6d(0x1ba)],'rolling':!![],'store':sessionStore,'cookie':{'maxAge':0x1b77400}})),app[_0x460b6d(0x1d3)](_0x460b6d(0x1a3),api_router_1['apiRouter']),app[_0x460b6d(0x1d3)](_0x460b6d(0x1d1),express_1[_0x460b6d(0x1e4)]['static'](path[_0x460b6d(0x1a0)](__dirname,_0x460b6d(0x1d1)))),app[_0x460b6d(0x1b5)](_0x460b6d(0x1b9),_0x460b6d(0x1a9)),app[_0x460b6d(0x1b5)](_0x460b6d(0x1cf),path[_0x460b6d(0x1a0)](__dirname,_0x460b6d(0x1cf))),app[_0x460b6d(0x1b5)]('view\x20options',{'delimiter':'?'}),app[_0x460b6d(0x1d3)]((0x0,express_1[_0x460b6d(0x1c3)])({'extended':!![]})),app[_0x460b6d(0x1d3)]((0x0,csurf_1[_0x460b6d(0x1e4)])()),app[_0x460b6d(0x1d3)](function(_0x4728ef,_0x224683,_0x7fcb99,_0x267359){const _0x957984=_0x460b6d;console[_0x957984(0x1ac)](_0x957984(0x1c6)),console[_0x957984(0x1ac)](_0x4728ef);if(_0x4728ef['code']!=='EBADCSRFTOKEN')return _0x267359(_0x4728ef);return _0x7fcb99[_0x957984(0x1af)](0x193)[_0x957984(0x1d8)]({'text':_0x957984(0x1d0),'status':![]});}),app[_0x460b6d(0x1d3)]((_0x58fdcf,_0x227ccd,_0x5e96bf)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x37dba8=_0x460b6d;try{_0x227ccd[_0x37dba8(0x1c9)][_0x37dba8(0x1df)]=_0x58fdcf[_0x37dba8(0x1b6)]['isUserLoggedIn'],_0x227ccd[_0x37dba8(0x1c9)][_0x37dba8(0x1e0)]=_0x58fdcf[_0x37dba8(0x1e0)](),_0x227ccd[_0x37dba8(0x1c9)][_0x37dba8(0x19f)]=[],_0x227ccd[_0x37dba8(0x1c9)][_0x37dba8(0x1a1)]=[],_0x227ccd[_0x37dba8(0x1c9)][_0x37dba8(0x1c5)]=_0x58fdcf[_0x37dba8(0x1c5)],_0x227ccd['locals'][_0x37dba8(0x1ab)]=_0x58fdcf[_0x37dba8(0x1be)],_0x5e96bf();}catch(_0x5b5c89){return console[_0x37dba8(0x1d0)]('error\x20in\x20locals'),console['dir'](_0x5b5c89),_0x227ccd[_0x37dba8(0x1d8)]({'status':![],'text':_0x37dba8(0x1a8)});}})),app[_0x460b6d(0x1d3)]('/dashboard',dashboard_route_1['dashboardRoute']),app['use'](_0x460b6d(0x1e2),(_0x4e534f,_0x1cb964)=>{const _0x2a1943=_0x460b6d;return _0x1cb964[_0x2a1943(0x1bc)]('error/404.ejs');}),app['use'](_0x460b6d(0x1bf),(_0x1ca037,_0xbd0db6)=>{const _0x18d3d1=_0x460b6d;return _0xbd0db6[_0x18d3d1(0x1bc)](_0x18d3d1(0x19c));});const PORT=process[_0x460b6d(0x1a7)][_0x460b6d(0x1c8)]||0x2260;(0x0,db_1['default'])()[_0x460b6d(0x1ae)](()=>{const _0x4f6ebd=_0x460b6d;console[_0x4f6ebd(0x1ac)](_0x4f6ebd(0x1bb)),mqtt_1[_0x4f6ebd(0x1e4)]['getInstance']()[_0x4f6ebd(0x1b8)](),app['listen'](PORT,()=>console[_0x4f6ebd(0x1ac)]('server\x20start\x20at\x20'+PORT));});