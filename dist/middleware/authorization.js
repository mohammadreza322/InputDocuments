'use strict';const _0x5794c5=_0x55b7;(function(_0x3e7cc1,_0x21a915){const _0x1805aa=_0x55b7,_0x65b0a4=_0x3e7cc1();while(!![]){try{const _0x3d52c0=parseInt(_0x1805aa(0xb6))/0x1*(parseInt(_0x1805aa(0xbd))/0x2)+-parseInt(_0x1805aa(0xc7))/0x3*(parseInt(_0x1805aa(0xcd))/0x4)+parseInt(_0x1805aa(0xd1))/0x5*(parseInt(_0x1805aa(0xae))/0x6)+-parseInt(_0x1805aa(0xa5))/0x7+-parseInt(_0x1805aa(0xc8))/0x8*(-parseInt(_0x1805aa(0xd3))/0x9)+-parseInt(_0x1805aa(0xa1))/0xa*(-parseInt(_0x1805aa(0xa3))/0xb)+-parseInt(_0x1805aa(0xb2))/0xc;if(_0x3d52c0===_0x21a915)break;else _0x65b0a4['push'](_0x65b0a4['shift']());}catch(_0x100a1c){_0x65b0a4['push'](_0x65b0a4['shift']());}}}(_0x1037,0x9ffe4));var __awaiter=this&&this[_0x5794c5(0xc4)]||function(_0x2a5b0e,_0x4d2db1,_0x133d5f,_0x2d792e){function _0x1906f2(_0x2effce){return _0x2effce instanceof _0x133d5f?_0x2effce:new _0x133d5f(function(_0x5efd28){_0x5efd28(_0x2effce);});}return new(_0x133d5f||(_0x133d5f=Promise))(function(_0x224866,_0x592257){const _0x1c96d9=_0x55b7;function _0x80b60e(_0x25007a){const _0x4bc281=_0x55b7;try{_0x212b00(_0x2d792e[_0x4bc281(0xd4)](_0x25007a));}catch(_0x2871b4){_0x592257(_0x2871b4);}}function _0x2704cd(_0xbe002a){const _0x2c21d5=_0x55b7;try{_0x212b00(_0x2d792e[_0x2c21d5(0x8c)](_0xbe002a));}catch(_0x43bfc3){_0x592257(_0x43bfc3);}}function _0x212b00(_0x45430b){const _0x37c14c=_0x55b7;_0x45430b['done']?_0x224866(_0x45430b[_0x37c14c(0x9c)]):_0x1906f2(_0x45430b[_0x37c14c(0x9c)])[_0x37c14c(0x76)](_0x80b60e,_0x2704cd);}_0x212b00((_0x2d792e=_0x2d792e[_0x1c96d9(0xac)](_0x2a5b0e,_0x4d2db1||[]))['next']());});},__importDefault=this&&this[_0x5794c5(0x88)]||function(_0x1797a8){const _0x4cd015=_0x5794c5;return _0x1797a8&&_0x1797a8[_0x4cd015(0x79)]?_0x1797a8:{'default':_0x1797a8};};function _0x55b7(_0x331c79,_0x29a78b){const _0x103760=_0x1037();return _0x55b7=function(_0x55b748,_0x1d631f){_0x55b748=_0x55b748-0x76;let _0xf7802e=_0x103760[_0x55b748];return _0xf7802e;},_0x55b7(_0x331c79,_0x29a78b);}Object[_0x5794c5(0x7b)](exports,_0x5794c5(0x79),{'value':!![]}),exports[_0x5794c5(0x8f)]=exports[_0x5794c5(0xc9)]=exports[_0x5794c5(0xa2)]=void 0x0;const permission_model_1=__importDefault(require('../models/permission.model')),isJWT_1=__importDefault(require('validator/lib/isJWT')),tokens_model_1=__importDefault(require(_0x5794c5(0xcf))),constants_1=require('../utility/constants'),users_model_1=__importDefault(require('../models/users.model')),user_entity_1=__importDefault(require('../entities/user.entity')),jwt=require(_0x5794c5(0xbb)),getAuthorization=(_0x4783ae,_0x2563e9,_0x4c08b7)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x4bd13f=_0x5794c5;return _0x4c08b7();const _0x490eff=_0x4783ae[_0x4bd13f(0x85)](_0x4bd13f(0xb9));try{if(!_0x490eff)return _0x2563e9[_0x4bd13f(0x7d)]({'message':'Token\x20is\x20not\x20valid!1','refreshToken1':!![]});if(!(0x0,isJWT_1[_0x4bd13f(0x8d)])(_0x490eff))return _0x2563e9['json']({'message':_0x4bd13f(0xd0),'refreshToken1':!![]});const _0x4bb7d8=yield tokens_model_1[_0x4bd13f(0x8d)][_0x4bd13f(0x8a)]({'token':_0x490eff});if(!_0x4bb7d8)return _0x2563e9[_0x4bd13f(0x7d)]({'message':_0x4bd13f(0x7c),'refreshToken1':!![]});const _0x268f2c=jwt[_0x4bd13f(0xb1)](_0x490eff,constants_1['jsonWebTokenSecretKey']),_0x432a15=yield users_model_1[_0x4bd13f(0x8d)][_0x4bd13f(0x82)](_0x268f2c['id']);if(!_0x432a15)return _0x2563e9['json']({'message':_0x4bd13f(0x9b),'refreshToken1':!![]});return _0x4783ae['userDetails']=_0x432a15,_0x4783ae[_0x4bd13f(0x92)]=_0x432a15[_0x4bd13f(0xa8)],_0x4c08b7();}catch(_0x43e76a){return console[_0x4bd13f(0xa4)](_0x4bd13f(0xb4)),console[_0x4bd13f(0xa4)](_0x43e76a),_0x2563e9[_0x4bd13f(0x7d)]({'message':_0x4bd13f(0x94),'refreshToken1':!![]});}});exports[_0x5794c5(0xa2)]=getAuthorization;const hasPermission=(_0x4af584,_0x9afba3,_0x16be65)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x22c593=_0x5794c5;try{const {userDetails:_0x11cfff}=_0x4af584;if(!_0x11cfff)return _0x9afba3[_0x22c593(0xca)](0x194)[_0x22c593(0x7d)]({'message':_0x22c593(0x93)});let _0x5a49df=null;_0x4af584[_0x22c593(0xa9)][_0x22c593(0x89)](0x0)==='/'?_0x5a49df=_0x4af584[_0x22c593(0x9e)]+_0x4af584[_0x22c593(0xa9)]:_0x5a49df=_0x4af584[_0x22c593(0x9e)]+'/'+_0x4af584[_0x22c593(0xa9)];const _0x442c21=_0x4af584[_0x22c593(0xad)];_0x5a49df[_0x5a49df[_0x22c593(0xc5)]-0x1]==='/'&&(_0x5a49df=_0x5a49df[_0x22c593(0xb0)](0x0,_0x5a49df[_0x22c593(0xc5)]-0x1));const _0x49e486=yield permission_model_1[_0x22c593(0x8d)][_0x22c593(0x8a)]({'role':_0x11cfff[_0x22c593(0x90)]}),_0x2e04dc=_0x49e486===null||_0x49e486===void 0x0?void 0x0:_0x49e486[_0x22c593(0xb3)](_0x442c21[_0x22c593(0xa6)]())[_0x22c593(0xbf)](_0x1c3e75=>{const _0x44d2b9=_0x22c593,_0x1ea7e9=new RegExp(_0x1c3e75);return _0x1ea7e9[_0x44d2b9(0xaf)](_0x5a49df);});if(!_0x2e04dc)return _0x9afba3[_0x22c593(0xca)](0x194)['json']({'message':'permission\x20denied'});return _0x16be65();}catch(_0x289aaf){return console['error'](_0x22c593(0x87)),console[_0x22c593(0xa4)](_0x289aaf),_0x9afba3[_0x22c593(0xca)](0x1f4)[_0x22c593(0x7d)]({'message':_0x22c593(0x9a)});}});function _0x1037(){const _0x480ee6=['fullName','914170kWUfTn','getAuthorization','77YFptPL','error','6340775yNSFzb','toUpperCase','storehouse','_id','path','client','3d-cube-scan.svg','apply','method','4489962xsVAZT','test','substring','verify','3393552siPogB','get','authorization\x20error','پیشخوان','1SfEwAG','مدیران','cpu.svg','x-auth-token','locals','jsonwebtoken','phoneNumber','302758goINUg','GET','find','includes','userPhone','dashboard','filter','__awaiter','length','user.svg','4506VTrcVY','1072UOSVuc','hasPermission','status','مشتریان','/dashboard','1740kWQSim','session','../models/tokens.model','Token\x20is\x20not\x20valid!2','5FtddPD','user','64323VitgNu','next','then','isUserLoggedIn','profile-2user.svg','__esModule','/dashboard/admin','defineProperty','Token\x20is\x20not\x20valid3','json','inside\x20site\x20permission\x20middle\x20\x20ware','/dashboard/store_room','دسترسی\x20غیر\x20مجاز','route','findById','initialRoute','دستگاه‌ها','header','redirect','inside\x20permission\x20middle\x20\x20ware','__importDefault','charAt','findOne','/dashboard/devices','throw','default','split','hasPermissionDashboard','role','element-4.svg','userId','permission\x20denied','Token\x20is\x20not\x20valid!7','/error/403','routes','/dashboard/client','/dashboard/auth','devices','خطایی\x20پیش\x20آمده!','Token\x20is\x20not\x20valid!6','value','admin','baseUrl','انبار'];_0x1037=function(){return _0x480ee6;};return _0x1037();}exports[_0x5794c5(0xc9)]=hasPermission;const hasPermissionDashboard=(_0x3001b3,_0x141232,_0x330443)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x24b1c5=_0x5794c5;try{if(!_0x3001b3[_0x24b1c5(0xce)][_0x24b1c5(0x77)])return _0x141232[_0x24b1c5(0x86)](_0x24b1c5(0x98));const _0x1d7013=_0x3001b3[_0x24b1c5(0xce)][_0x24b1c5(0xc1)],_0x3d93a3=yield user_entity_1[_0x24b1c5(0x8d)]['getUserInformationWithPhoneNumber'](_0x1d7013);if(!_0x3d93a3)return _0x3001b3[_0x24b1c5(0xce)]['isUserLoggedIn']=![],_0x141232[_0x24b1c5(0x86)](_0x24b1c5(0x98));if(_0x3d93a3[_0x24b1c5(0x90)]=='user')return _0x141232['redirect'](_0x24b1c5(0x95));let _0x53059c=null;_0x3001b3[_0x24b1c5(0xa9)][_0x24b1c5(0x89)](0x0)==='/'?_0x53059c=_0x3001b3[_0x24b1c5(0x9e)]+_0x3001b3[_0x24b1c5(0xa9)]:_0x53059c=_0x3001b3[_0x24b1c5(0x9e)]+'/'+_0x3001b3[_0x24b1c5(0xa9)];const _0x892f10=_0x3001b3[_0x24b1c5(0xad)];_0x53059c[_0x53059c[_0x24b1c5(0xc5)]-0x1]==='/'&&(_0x53059c=_0x53059c[_0x24b1c5(0xb0)](0x0,_0x53059c[_0x24b1c5(0xc5)]-0x1));const _0x6ebc7b=yield permission_model_1[_0x24b1c5(0x8d)][_0x24b1c5(0x8a)]({'role':_0x3d93a3[_0x24b1c5(0x90)]});if(!_0x6ebc7b)return _0x141232[_0x24b1c5(0x86)](_0x24b1c5(0x98));const _0x48937d=_0x6ebc7b['get'](_0x892f10['toUpperCase']())[_0x24b1c5(0xbf)](_0x4029e=>{const _0x135bad=_0x24b1c5,_0x113194=new RegExp(_0x4029e);return _0x113194[_0x135bad(0xaf)](_0x53059c);});if(!_0x48937d)return _0x892f10[_0x24b1c5(0xa6)]()==_0x24b1c5(0xbe)&&_0x141232[_0x24b1c5(0x86)](_0x6ebc7b[_0x24b1c5(0x83)]),_0x141232[_0x24b1c5(0x7d)]({'status':![],'message':_0x24b1c5(0x80)});_0x3001b3[_0x24b1c5(0xd2)]=_0x3d93a3,_0x141232[_0x24b1c5(0xba)]['userName']=_0x3d93a3[_0x24b1c5(0xa0)][_0x24b1c5(0x8e)]('\x20')[0x0],_0x141232[_0x24b1c5(0xba)]['fullName']=_0x3d93a3[_0x24b1c5(0xa0)],_0x141232[_0x24b1c5(0xba)][_0x24b1c5(0xbc)]=_0x3d93a3[_0x24b1c5(0xbc)],_0x141232[_0x24b1c5(0xba)][_0x24b1c5(0x90)]=_0x3d93a3[_0x24b1c5(0x90)];const _0x60a28e=[{'route':_0x24b1c5(0xcc),'title':_0x24b1c5(0xb5),'image':_0x24b1c5(0x91),'name':_0x24b1c5(0xc2)},{'route':_0x24b1c5(0x7a),'title':_0x24b1c5(0xb7),'image':_0x24b1c5(0xc6),'name':_0x24b1c5(0x9d)},{'route':_0x24b1c5(0x97),'title':_0x24b1c5(0xcb),'image':_0x24b1c5(0x78),'name':_0x24b1c5(0xaa)},{'route':_0x24b1c5(0x8b),'title':_0x24b1c5(0x84),'image':_0x24b1c5(0xb8),'name':_0x24b1c5(0x99)},{'route':_0x24b1c5(0x7f),'title':_0x24b1c5(0x9f),'image':_0x24b1c5(0xab),'name':_0x24b1c5(0xa7)}];return _0x141232[_0x24b1c5(0xba)][_0x24b1c5(0x96)]=_0x60a28e[_0x24b1c5(0xc3)](_0xc51eb5=>_0x6ebc7b===null||_0x6ebc7b===void 0x0?void 0x0:_0x6ebc7b[_0x24b1c5(0xb3)](_0x892f10[_0x24b1c5(0xa6)]())[_0x24b1c5(0xc0)](_0xc51eb5[_0x24b1c5(0x81)])),_0x330443();}catch(_0x2d19d8){return console[_0x24b1c5(0xa4)](_0x24b1c5(0x7e)),console[_0x24b1c5(0xa4)](_0x2d19d8),_0x141232['status'](0x1f4)['json']({'message':_0x24b1c5(0x9a)});}});exports[_0x5794c5(0x8f)]=hasPermissionDashboard;