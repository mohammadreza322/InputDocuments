'use strict';const _0x3466af=_0x23ea;function _0x23ea(_0x3d9853,_0x186c6c){const _0x568f6e=_0x568f();return _0x23ea=function(_0x23ea02,_0x234a1d){_0x23ea02=_0x23ea02-0x71;let _0x264ef9=_0x568f6e[_0x23ea02];return _0x264ef9;},_0x23ea(_0x3d9853,_0x186c6c);}(function(_0x5dc9cc,_0x17eba2){const _0x2987de=_0x23ea,_0x462a89=_0x5dc9cc();while(!![]){try{const _0x43633a=parseInt(_0x2987de(0xa3))/0x1*(parseInt(_0x2987de(0xb2))/0x2)+-parseInt(_0x2987de(0xc8))/0x3*(parseInt(_0x2987de(0xb6))/0x4)+-parseInt(_0x2987de(0xcd))/0x5+parseInt(_0x2987de(0x83))/0x6+parseInt(_0x2987de(0x99))/0x7*(parseInt(_0x2987de(0xac))/0x8)+-parseInt(_0x2987de(0x7b))/0x9*(parseInt(_0x2987de(0xb5))/0xa)+parseInt(_0x2987de(0x89))/0xb;if(_0x43633a===_0x17eba2)break;else _0x462a89['push'](_0x462a89['shift']());}catch(_0x315924){_0x462a89['push'](_0x462a89['shift']());}}}(_0x568f,0xc6edd));var __awaiter=this&&this[_0x3466af(0x91)]||function(_0xddeca8,_0xa33651,_0x3165d9,_0x4957bc){function _0x29676a(_0x27c125){return _0x27c125 instanceof _0x3165d9?_0x27c125:new _0x3165d9(function(_0x36a0b6){_0x36a0b6(_0x27c125);});}return new(_0x3165d9||(_0x3165d9=Promise))(function(_0x507de6,_0x3f4d2d){const _0xb1e537=_0x23ea;function _0x460409(_0x127117){const _0x5d1ede=_0x23ea;try{_0x4e77a5(_0x4957bc[_0x5d1ede(0x96)](_0x127117));}catch(_0x503865){_0x3f4d2d(_0x503865);}}function _0x1a52ec(_0x504341){const _0x5d30bf=_0x23ea;try{_0x4e77a5(_0x4957bc[_0x5d30bf(0x9e)](_0x504341));}catch(_0x284fa1){_0x3f4d2d(_0x284fa1);}}function _0x4e77a5(_0x5d8adc){const _0x24458d=_0x23ea;_0x5d8adc['done']?_0x507de6(_0x5d8adc[_0x24458d(0x73)]):_0x29676a(_0x5d8adc['value'])[_0x24458d(0xbc)](_0x460409,_0x1a52ec);}_0x4e77a5((_0x4957bc=_0x4957bc['apply'](_0xddeca8,_0xa33651||[]))[_0xb1e537(0x96)]());});},__importDefault=this&&this[_0x3466af(0x9b)]||function(_0x5880e5){const _0x15560c=_0x3466af;return _0x5880e5&&_0x5880e5[_0x15560c(0xc3)]?_0x5880e5:{'default':_0x5880e5};};Object[_0x3466af(0xad)](exports,_0x3466af(0xc3),{'value':!![]}),exports['hasPermissionDashboard']=exports[_0x3466af(0xc4)]=exports[_0x3466af(0x81)]=void 0x0;const permission_model_1=__importDefault(require(_0x3466af(0xb8))),isJWT_1=__importDefault(require('validator/lib/isJWT')),tokens_model_1=__importDefault(require(_0x3466af(0xc5))),constants_1=require(_0x3466af(0x77)),users_model_1=__importDefault(require(_0x3466af(0x94))),user_entity_1=__importDefault(require(_0x3466af(0xc2))),jwt=require('jsonwebtoken'),getAuthorization=(_0xe7fb00,_0xbb2b57,_0x3d9512)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x14cbe6=_0x3466af,_0x525cfb=_0xe7fb00[_0x14cbe6(0xb3)](_0x14cbe6(0x8b));try{if(!_0x525cfb)return _0xbb2b57[_0x14cbe6(0xc9)]({'message':_0x14cbe6(0x85),'refreshToken1':!![]});if(!(0x0,isJWT_1[_0x14cbe6(0xc6)])(_0x525cfb))return _0xbb2b57[_0x14cbe6(0xc9)]({'message':'Token\x20is\x20not\x20valid!2','refreshToken1':!![]});const _0x4331e0=yield tokens_model_1[_0x14cbe6(0xc6)]['findOne']({'token':_0x525cfb});if(!_0x4331e0)return _0xbb2b57[_0x14cbe6(0xc9)]({'message':_0x14cbe6(0x7e),'refreshToken1':!![]});const _0x12e471=jwt[_0x14cbe6(0xa0)](_0x525cfb,constants_1['jsonWebTokenSecretKey']),_0x5431a9=yield users_model_1['default'][_0x14cbe6(0x93)](_0x12e471['id']);if(!_0x5431a9)return _0xbb2b57[_0x14cbe6(0xc9)]({'message':_0x14cbe6(0xa8),'refreshToken1':!![]});return _0xe7fb00[_0x14cbe6(0x8c)]=_0x5431a9,_0xe7fb00[_0x14cbe6(0x9c)]=_0x5431a9['_id'],_0x3d9512();}catch(_0x30e3a6){return console[_0x14cbe6(0x75)](_0x14cbe6(0x95)),console['error'](_0x30e3a6),_0xbb2b57[_0x14cbe6(0xc9)]({'message':_0x14cbe6(0x7f),'refreshToken1':!![]});}});exports[_0x3466af(0x81)]=getAuthorization;const hasPermission=(_0x5742ea,_0x3bfc1d,_0x3f4e5a)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x4fe116=_0x3466af;try{const {userDetails:_0x1c0119}=_0x5742ea;if(!_0x1c0119)return _0x3bfc1d[_0x4fe116(0x82)](0x194)[_0x4fe116(0xc9)]({'message':_0x4fe116(0xca)});let _0x5b4297=null;_0x5742ea['path'][_0x4fe116(0x7d)](0x0)==='/'?_0x5b4297=_0x5742ea['baseUrl']+_0x5742ea[_0x4fe116(0x9a)]:_0x5b4297=_0x5742ea[_0x4fe116(0xc0)]+'/'+_0x5742ea[_0x4fe116(0x9a)];const _0x36e684=_0x5742ea[_0x4fe116(0x90)];_0x5b4297[_0x5b4297['length']-0x1]==='/'&&(_0x5b4297=_0x5b4297['substring'](0x0,_0x5b4297['length']-0x1));const _0x4783ef=yield permission_model_1[_0x4fe116(0xc6)][_0x4fe116(0xb4)]({'role':_0x1c0119['role']});console['log']('***********'),console[_0x4fe116(0xbf)](_0x5b4297),console[_0x4fe116(0xbf)](_0x36e684);return _0x3f4e5a();const _0x24b9de=_0x4783ef===null||_0x4783ef===void 0x0?void 0x0:_0x4783ef['get'](_0x36e684['toUpperCase']())[_0x4fe116(0xc1)](_0x36641c=>{const _0x218748=_0x4fe116,_0x30acee=new RegExp(_0x36641c);return _0x30acee[_0x218748(0xab)](_0x5b4297);});console[_0x4fe116(0xbf)](_0x24b9de),console[_0x4fe116(0xbf)]({'hasPermission':_0x24b9de,'path':_0x5b4297,'method':_0x36e684});if(!_0x24b9de)return console[_0x4fe116(0xbf)](_0x4fe116(0x76)),_0x3bfc1d[_0x4fe116(0x82)](0x194)[_0x4fe116(0xc9)]({'message':_0x4fe116(0xca)});return _0x3f4e5a();}catch(_0x32d1c7){return console[_0x4fe116(0x75)](_0x4fe116(0xba)),console[_0x4fe116(0x75)](_0x32d1c7),_0x3bfc1d['status'](0x1f4)[_0x4fe116(0xc9)]({'message':'خطایی\x20پیش\x20آمده!'});}});function _0x568f(){const _0x537082=['__esModule','hasPermission','../models/tokens.model','default','getUserInformationWithPhoneNumber','12AolVUB','json','permission\x20denied','/auth','session','2822390QlBVqu','/devices','profile-2user.svg','isUserLoggedIn','/dashboard','value','cpu.svg','error','fuuuuuuuuuuuuuuuuuuck','../utility/constants','element-4.svg','inside\x20site\x20permission\x20middle\x20\x20ware','phoneNumber','9pjaykn','###############################','charAt','Token\x20is\x20not\x20valid3','Token\x20is\x20not\x20valid!7','/error/403','getAuthorization','status','1994034mloGoJ','route','Token\x20is\x20not\x20valid!1','filter','locals','مدیران','23493019szAidc','dashboard','x-auth-token','userDetails','length','user','userName','method','__awaiter','hasPermissionDashboard','findById','../models/users.model','authorization\x20error','next','routes','client','3825577KwXbYE','path','__importDefault','userId','split','throw','GET','decode','substring','/client','1dcnqWw','initialRoute','user.svg','userPhone','3d-cube-scan.svg','Token\x20is\x20not\x20valid!6','storehouse','role','test','8xDcYzt','defineProperty','toUpperCase','پیشخوان','دستگاه‌ها','admin','1515604iGFnLt','header','findOne','12141940kXsTvo','1178896gKbPsi','انبار','../models/permission.model','fullName','inside\x20permission\x20middle\x20\x20ware','includes','then','دسترسی\x20غیر\x20مجاز','redirect','log','baseUrl','find','../entities/user.entity'];_0x568f=function(){return _0x537082;};return _0x568f();}exports[_0x3466af(0xc4)]=hasPermission;const hasPermissionDashboard=(_0x25a73f,_0x4cf8f0,_0x4e3456)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x590dde=_0x3466af;try{if(!_0x25a73f[_0x590dde(0xcc)][_0x590dde(0x71)])return _0x4cf8f0[_0x590dde(0xbe)](_0x590dde(0xcb));const _0x2703da=_0x25a73f['session'][_0x590dde(0xa6)],_0x452f09=yield user_entity_1[_0x590dde(0xc6)][_0x590dde(0xc7)](_0x2703da);if(!_0x452f09)return _0x25a73f['session'][_0x590dde(0x71)]=![],_0x4cf8f0[_0x590dde(0xbe)](_0x590dde(0xcb));if(_0x452f09[_0x590dde(0xaa)]==_0x590dde(0x8e))return _0x4cf8f0[_0x590dde(0xbe)](_0x590dde(0x80));let _0x475c1d=null;_0x25a73f[_0x590dde(0x9a)][_0x590dde(0x7d)](0x0)==='/'?_0x475c1d=_0x25a73f['baseUrl']+_0x25a73f[_0x590dde(0x9a)]:_0x475c1d=_0x25a73f[_0x590dde(0xc0)]+'/'+_0x25a73f[_0x590dde(0x9a)];const _0x47f407=_0x25a73f[_0x590dde(0x90)];_0x475c1d[_0x475c1d[_0x590dde(0x8d)]-0x1]==='/'&&(_0x475c1d=_0x475c1d[_0x590dde(0xa1)](0x0,_0x475c1d['length']-0x1));const _0x5885a3=yield permission_model_1['default'][_0x590dde(0xb4)]({'role':_0x452f09[_0x590dde(0xaa)]});if(!_0x5885a3)return _0x4cf8f0[_0x590dde(0xbe)](_0x590dde(0xcb));const _0x242de4=_0x5885a3['get'](_0x47f407[_0x590dde(0xae)]())['find'](_0xd72c26=>{const _0x5b44a1=_0x590dde,_0x55780b=new RegExp(_0xd72c26);return _0x55780b[_0x5b44a1(0xab)](_0x475c1d);});if(!_0x242de4)return _0x47f407[_0x590dde(0xae)]()==_0x590dde(0x9f)&&_0x4cf8f0[_0x590dde(0xbe)](_0x5885a3[_0x590dde(0xa4)]),_0x4cf8f0['json']({'status':![],'message':_0x590dde(0xbd)});_0x25a73f[_0x590dde(0x8e)]=_0x452f09,_0x4cf8f0['locals'][_0x590dde(0x8f)]=_0x452f09[_0x590dde(0xb9)][_0x590dde(0x9d)]('\x20')[0x0],_0x4cf8f0[_0x590dde(0x87)][_0x590dde(0xb9)]=_0x452f09[_0x590dde(0xb9)],_0x4cf8f0[_0x590dde(0x87)][_0x590dde(0x7a)]=_0x452f09['phoneNumber'],_0x4cf8f0[_0x590dde(0x87)][_0x590dde(0xaa)]=_0x452f09[_0x590dde(0xaa)];const _0xf9bb7f=[{'route':'/','title':_0x590dde(0xaf),'image':_0x590dde(0x78),'name':_0x590dde(0x8a)},{'route':'/admin','title':_0x590dde(0x88),'image':_0x590dde(0xa5),'name':_0x590dde(0xb1)},{'route':_0x590dde(0xa2),'title':'مشتریان','image':_0x590dde(0xcf),'name':_0x590dde(0x98)},{'route':_0x590dde(0xce),'title':_0x590dde(0xb0),'image':_0x590dde(0x74),'name':'devices'},{'route':'/store_room','title':_0x590dde(0xb7),'image':_0x590dde(0xa7),'name':_0x590dde(0xa9)}];return console[_0x590dde(0xbf)](_0x590dde(0x7c)),_0x4cf8f0[_0x590dde(0x87)][_0x590dde(0x97)]=_0xf9bb7f[_0x590dde(0x86)](_0x3ba12b=>{const _0x5ad2ae=_0x590dde,_0x414007=_0x3ba12b['route']=='/'?_0x5ad2ae(0x72):_0x5ad2ae(0x72)+_0x3ba12b[_0x5ad2ae(0x84)];return _0x5885a3===null||_0x5885a3===void 0x0?void 0x0:_0x5885a3['get'](_0x47f407[_0x5ad2ae(0xae)]())[_0x5ad2ae(0xbb)](_0x414007);}),console[_0x590dde(0xbf)](_0x4cf8f0[_0x590dde(0x87)][_0x590dde(0x97)]),_0x4e3456();}catch(_0x2072f1){return console[_0x590dde(0x75)](_0x590dde(0x79)),console[_0x590dde(0x75)](_0x2072f1),_0x4cf8f0[_0x590dde(0x82)](0x1f4)[_0x590dde(0xc9)]({'message':'خطایی\x20پیش\x20آمده!'});}});exports[_0x3466af(0x92)]=hasPermissionDashboard;